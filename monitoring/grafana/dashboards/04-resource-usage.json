{
  "dashboard": {
    "title": "AI Sales Platform - Resource Usage",
    "uid": "ai-sales-resource-usage",
    "timezone": "browser",
    "editable": true,
    "panels": [
      {
        "id": 1,
        "title": "CPU Usage",
        "type": "graph",
        "targets": [
          {
            "expr": "(1 - avg(rate(node_cpu_seconds_total{mode=\"idle\"}[5m]))) * 100",
            "legendFormat": "Total CPU Usage %"
          },
          {
            "expr": "(1 - avg(rate(node_cpu_seconds_total{mode=\"idle\"}[5m])) by (cpu)) * 100",
            "legendFormat": "CPU {{cpu}}"
          }
        ],
        "yaxes": [
          {"format": "percent", "label": "CPU Usage %", "min": 0, "max": 100},
          {"format": "short"}
        ],
        "alert": {
          "conditions": [
            {
              "evaluator": {"params": [85], "type": "gt"},
              "query": {"params": ["A", "5m", "now"]},
              "type": "query"
            }
          ],
          "executionErrorState": "alerting",
          "frequency": "1m",
          "handler": 1,
          "name": "High CPU Usage Alert",
          "noDataState": "no_data"
        },
        "gridPos": {"h": 8, "w": 12, "x": 0, "y": 0}
      },
      {
        "id": 2,
        "title": "Memory Usage",
        "type": "graph",
        "targets": [
          {
            "expr": "node_memory_MemTotal_bytes - node_memory_MemAvailable_bytes",
            "legendFormat": "Used Memory"
          },
          {
            "expr": "node_memory_MemAvailable_bytes",
            "legendFormat": "Available Memory"
          },
          {
            "expr": "node_memory_MemTotal_bytes",
            "legendFormat": "Total Memory"
          }
        ],
        "yaxes": [
          {"format": "bytes", "label": "Memory"},
          {"format": "short"}
        ],
        "gridPos": {"h": 8, "w": 12, "x": 12, "y": 0}
      },
      {
        "id": 3,
        "title": "Memory Usage Percentage",
        "type": "gauge",
        "targets": [
          {
            "expr": "(1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)) * 100",
            "legendFormat": "Memory Usage %"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "percent",
            "min": 0,
            "max": 100,
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {"value": 0, "color": "green"},
                {"value": 70, "color": "yellow"},
                {"value": 85, "color": "red"}
              ]
            }
          }
        },
        "gridPos": {"h": 6, "w": 6, "x": 0, "y": 8}
      },
      {
        "id": 4,
        "title": "Disk Usage Percentage",
        "type": "gauge",
        "targets": [
          {
            "expr": "(1 - (node_filesystem_avail_bytes{mountpoint=\"/\"} / node_filesystem_size_bytes{mountpoint=\"/\"})) * 100",
            "legendFormat": "Disk Usage %"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "percent",
            "min": 0,
            "max": 100,
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {"value": 0, "color": "green"},
                {"value": 70, "color": "yellow"},
                {"value": 85, "color": "red"}
              ]
            }
          }
        },
        "gridPos": {"h": 6, "w": 6, "x": 6, "y": 8}
      },
      {
        "id": 5,
        "title": "Network I/O Rate",
        "type": "graph",
        "targets": [
          {
            "expr": "rate(node_network_receive_bytes_total[5m])",
            "legendFormat": "Receive {{device}}"
          },
          {
            "expr": "rate(node_network_transmit_bytes_total[5m])",
            "legendFormat": "Transmit {{device}}"
          }
        ],
        "yaxes": [
          {"format": "Bps", "label": "Bytes/sec"},
          {"format": "short"}
        ],
        "gridPos": {"h": 6, "w": 12, "x": 12, "y": 8}
      },
      {
        "id": 6,
        "title": "Disk I/O Rate",
        "type": "graph",
        "targets": [
          {
            "expr": "rate(node_disk_read_bytes_total[5m])",
            "legendFormat": "Read {{device}}"
          },
          {
            "expr": "rate(node_disk_written_bytes_total[5m])",
            "legendFormat": "Write {{device}}"
          }
        ],
        "yaxes": [
          {"format": "Bps", "label": "Bytes/sec"},
          {"format": "short"}
        ],
        "gridPos": {"h": 8, "w": 12, "x": 0, "y": 14}
      },
      {
        "id": 7,
        "title": "Disk IOPS",
        "type": "graph",
        "targets": [
          {
            "expr": "rate(node_disk_reads_completed_total[5m])",
            "legendFormat": "Read IOPS {{device}}"
          },
          {
            "expr": "rate(node_disk_writes_completed_total[5m])",
            "legendFormat": "Write IOPS {{device}}"
          }
        ],
        "yaxes": [
          {"format": "iops", "label": "Operations/sec"},
          {"format": "short"}
        ],
        "gridPos": {"h": 8, "w": 12, "x": 12, "y": 14}
      },
      {
        "id": 8,
        "title": "Network Connections",
        "type": "graph",
        "targets": [
          {
            "expr": "node_netstat_Tcp_CurrEstab",
            "legendFormat": "Established TCP Connections"
          },
          {
            "expr": "node_sockstat_TCP_inuse",
            "legendFormat": "TCP Sockets in Use"
          },
          {
            "expr": "node_sockstat_UDP_inuse",
            "legendFormat": "UDP Sockets in Use"
          }
        ],
        "yaxes": [
          {"format": "short", "label": "Connections"},
          {"format": "short"}
        ],
        "gridPos": {"h": 8, "w": 12, "x": 0, "y": 22}
      },
      {
        "id": 9,
        "title": "System Load Average",
        "type": "graph",
        "targets": [
          {
            "expr": "node_load1",
            "legendFormat": "1 min"
          },
          {
            "expr": "node_load5",
            "legendFormat": "5 min"
          },
          {
            "expr": "node_load15",
            "legendFormat": "15 min"
          }
        ],
        "yaxes": [
          {"format": "short", "label": "Load"},
          {"format": "short"}
        ],
        "gridPos": {"h": 8, "w": 12, "x": 12, "y": 22}
      },
      {
        "id": 10,
        "title": "File Descriptor Usage",
        "type": "graph",
        "targets": [
          {
            "expr": "process_open_fds{job=\"ai-sales-platform\"}",
            "legendFormat": "Open File Descriptors"
          },
          {
            "expr": "process_max_fds{job=\"ai-sales-platform\"}",
            "legendFormat": "Max File Descriptors"
          }
        ],
        "yaxes": [
          {"format": "short", "label": "File Descriptors"},
          {"format": "short"}
        ],
        "gridPos": {"h": 8, "w": 12, "x": 0, "y": 30}
      },
      {
        "id": 11,
        "title": "Process CPU Usage (Top 10)",
        "type": "table",
        "targets": [
          {
            "expr": "topk(10, rate(process_cpu_seconds_total[5m]) * 100)",
            "format": "table",
            "instant": true
          }
        ],
        "gridPos": {"h": 8, "w": 12, "x": 12, "y": 30}
      },
      {
        "id": 12,
        "title": "Container Memory Usage",
        "type": "graph",
        "targets": [
          {
            "expr": "container_memory_usage_bytes{container!=\"\"}",
            "legendFormat": "{{container}}"
          }
        ],
        "yaxes": [
          {"format": "bytes", "label": "Memory"},
          {"format": "short"}
        ],
        "gridPos": {"h": 8, "w": 12, "x": 0, "y": 38}
      },
      {
        "id": 13,
        "title": "Container CPU Usage",
        "type": "graph",
        "targets": [
          {
            "expr": "rate(container_cpu_usage_seconds_total{container!=\"\"}[5m]) * 100",
            "legendFormat": "{{container}}"
          }
        ],
        "yaxes": [
          {"format": "percent", "label": "CPU %"},
          {"format": "short"}
        ],
        "gridPos": {"h": 8, "w": 12, "x": 12, "y": 38}
      },
      {
        "id": 14,
        "title": "PostgreSQL Connection Pool Status",
        "type": "stat",
        "targets": [
          {
            "expr": "pg_stat_database_numbackends",
            "legendFormat": "Active Connections"
          }
        ],
        "gridPos": {"h": 4, "w": 6, "x": 0, "y": 46}
      },
      {
        "id": 15,
        "title": "PostgreSQL Transaction Rate",
        "type": "graph",
        "targets": [
          {
            "expr": "rate(pg_stat_database_xact_commit[5m])",
            "legendFormat": "Commits/sec"
          },
          {
            "expr": "rate(pg_stat_database_xact_rollback[5m])",
            "legendFormat": "Rollbacks/sec"
          }
        ],
        "yaxes": [
          {"format": "short", "label": "Transactions/sec"},
          {"format": "short"}
        ],
        "gridPos": {"h": 8, "w": 12, "x": 6, "y": 46}
      },
      {
        "id": 16,
        "title": "Database Cache Hit Ratio",
        "type": "gauge",
        "targets": [
          {
            "expr": "(sum(pg_stat_database_blks_hit) / (sum(pg_stat_database_blks_hit) + sum(pg_stat_database_blks_read))) * 100",
            "legendFormat": "Cache Hit %"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "percent",
            "min": 0,
            "max": 100,
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {"value": 0, "color": "red"},
                {"value": 90, "color": "yellow"},
                {"value": 95, "color": "green"}
              ]
            }
          }
        },
        "gridPos": {"h": 8, "w": 6, "x": 18, "y": 46}
      }
    ],
    "refresh": "30s",
    "time": {"from": "now-6h", "to": "now"},
    "timepicker": {
      "refresh_intervals": ["10s", "30s", "1m", "5m", "15m", "30m", "1h"]
    },
    "version": 1
  }
}
