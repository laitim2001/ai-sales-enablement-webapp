# Story 4.5: ç”Ÿç”¢ç´šæ€§èƒ½å„ªåŒ–èˆ‡é«˜å¯ç”¨æ€§æ¶æ§‹ï¼ˆè©³ç´°ç‰ˆï¼‰
> **ğŸŸ¡ MVP Priority: Phase 2** - ä¼æ¥­ç´šç”Ÿç”¢å°±ç·’å¿…è¦åŠŸèƒ½
> **â±ï¸ é ä¼°å·¥ä½œé‡**: 8-10å¤©
> **ğŸ‘¥ éœ€è¦è§’è‰²**: DevOpså·¥ç¨‹å¸«, å¾Œç«¯é–‹ç™¼è€…, å‰ç«¯é–‹ç™¼è€…

## User Story
ä½œç‚ºä¸€åç³»çµ±ç®¡ç†å“¡å’ŒDevOpså·¥ç¨‹å¸«ï¼Œ
æˆ‘éœ€è¦ç³»çµ±é”åˆ°ç”Ÿç”¢ç´šæ€§èƒ½æ¨™æº–å’Œé«˜å¯ç”¨æ€§æ¶æ§‹ï¼Œ
ä»¥ä¾¿èƒ½å¤ æ”¯æ´ä¼æ¥­ç´šç”¨æˆ¶è² è¼‰ï¼Œä¸¦ç¢ºä¿99.9%çš„ç³»çµ±å¯ç”¨æ€§å’Œå¿«é€Ÿç½é›£æ¢å¾©èƒ½åŠ›ã€‚

## èƒŒæ™¯èªªæ˜
MVP Phase 1æˆåŠŸäº¤ä»˜äº†æ ¸å¿ƒåŠŸèƒ½ï¼Œä½†è¦æˆç‚ºå¯éŠ·å”®çš„ä¼æ¥­ç´šç”¢å“ï¼Œå¿…é ˆç¢ºä¿ç³»çµ±èƒ½å¤ åœ¨ç”Ÿç”¢ç’°å¢ƒä¸­ç©©å®šé‹è¡Œï¼Œæ”¯æ´é«˜ä¸¦ç™¼ç”¨æˆ¶è¨ªå•ï¼Œä¸¦åœ¨æ•…éšœæ™‚å¿«é€Ÿæ¢å¾©ã€‚æ€§èƒ½å„ªåŒ–å’Œé«˜å¯ç”¨æ€§æ¶æ§‹æ˜¯ä¼æ¥­å®¢æˆ¶çš„åŸºæœ¬è¦æ±‚ã€‚

## åŠŸèƒ½ä¾†æº
æ­¤Storyæºè‡ª**é¸é …C - ç©©å¥å„ªåŒ–è·¯ç·š**ï¼Œæ˜¯åœ¨åˆ¶å®šMVP Phase 2è¨ˆåŠƒæ™‚ï¼Œæ ¹æ“šä¼æ¥­ç´šéœ€æ±‚åˆ†ææ–°å¢çš„å¢å¼·æ€§åŠŸèƒ½ã€‚é›–ç„¶ä¸åœ¨åŸå§‹24å€‹ç”¨æˆ¶æ•…äº‹ä¸­ï¼Œä½†å°æ–¼ç”¢å“çš„ä¼æ¥­ç´šå®šä½è‡³é—œé‡è¦ã€‚

## æŠ€è¡“è¦æ ¼
- **æ€§èƒ½ç›£æ§**: Lighthouse CI + Web Vitals
- **è² è¼‰æ¸¬è©¦**: k6 æˆ– Artillery
- **CDN**: Cloudflare æˆ– AWS CloudFront
- **è² è¼‰å‡è¡¡**: AWS ALB æˆ– Azure Load Balancer
- **å®¹éŒ¯æ¨¡å¼**: Circuit Breaker (Hystrix pattern)
- **å‚™ä»½**: è‡ªå‹•åŒ–è³‡æ–™åº«å‚™ä»½ + ç•°åœ°å­˜å„²

## é©—æ”¶æ¨™æº–

### 1. å‰ç«¯æ€§èƒ½å„ªåŒ–ï¼š
- é¦–é åŠ è¼‰æ™‚é–“ï¼ˆLCPï¼‰: <2ç§’ï¼ˆP95ï¼‰
- é¦–æ¬¡è¼¸å…¥å»¶é²ï¼ˆFIDï¼‰: <100ms
- ç´¯ç©å¸ƒå±€åç§»ï¼ˆCLSï¼‰: <0.1
- ä»£ç¢¼åˆ†å‰²ï¼ˆCode Splittingï¼‰å·²å¯¦æ–½
- æ‡¶åŠ è¼‰ï¼ˆLazy Loadingï¼‰å·²å¯¦æ–½æ‰€æœ‰åœ–ç‰‡å’Œçµ„ä»¶
- WebPåœ–ç‰‡æ ¼å¼å„ªåŒ–
- CDNæ•´åˆä¸¦é…ç½®

### 2. å¾Œç«¯æ€§èƒ½å„ªåŒ–ï¼š
- APIå¹³å‡éŸ¿æ‡‰æ™‚é–“: <200msï¼ˆP95ï¼‰
- è³‡æ–™åº«æŸ¥è©¢å„ªåŒ–ï¼šæ¶ˆé™¤æ‰€æœ‰N+1æŸ¥è©¢
- Redisç·©å­˜å‘½ä¸­ç‡: >70%
- APIéŸ¿æ‡‰å£“ç¸®ï¼ˆgzip/brotliï¼‰å·²å•Ÿç”¨
- è³‡æ–™åº«ç´¢å¼•å·²å„ªåŒ–ï¼ˆæ…¢æŸ¥è©¢<50msï¼‰
- é€£æ¥æ± é…ç½®å·²å„ªåŒ–

### 3. è² è¼‰èƒ½åŠ›èˆ‡æ“´å±•æ€§ï¼š
- æ”¯æ´1000+ä¸¦ç™¼ç”¨æˆ¶
- æ°´å¹³æ“´å±•æº–å‚™ï¼ˆç„¡ç‹€æ…‹æ‡‰ç”¨è¨­è¨ˆï¼‰
- æœƒè©±å­˜å„²é·ç§»è‡³Redis
- è² è¼‰å‡è¡¡å™¨é…ç½®ä¸¦æ¸¬è©¦
- è‡ªå‹•æ“´å±•ç­–ç•¥å®šç¾©
- è² è¼‰æ¸¬è©¦å ±å‘Šå®Œæˆ

### 4. é«˜å¯ç”¨æ€§æ¶æ§‹ï¼š
- ç³»çµ±å¯ç”¨æ€§ç›®æ¨™: >99.9%ï¼ˆæ¯æœˆåœæ©Ÿæ™‚é–“<43åˆ†é˜ï¼‰
- å¥åº·æª¢æŸ¥ç«¯é»ï¼ˆLiveness + Readinessï¼‰
- å„ªé›…é—œé–‰æ©Ÿåˆ¶ï¼ˆGraceful Shutdownï¼‰
- æœå‹™è‡ªå‹•é‡å•Ÿé…ç½®
- æ•…éšœè½‰ç§»æ©Ÿåˆ¶å·²æ¸¬è©¦
- é›¶åœæ©Ÿéƒ¨ç½²æµç¨‹

### 5. å®¹éŒ¯èˆ‡æ¢å¾©æ©Ÿåˆ¶ï¼š
- Circuit Breakeræ¨¡å¼å·²å¯¦æ–½ï¼ˆé—œéµå¤–éƒ¨æœå‹™ï¼‰
- é‡è©¦ç­–ç•¥é…ç½®ï¼ˆæŒ‡æ•¸é€€é¿ï¼‰
- å„ªé›…é™ç´šç­–ç•¥ï¼ˆAzure OpenAIã€CRMæœå‹™ï¼‰
- å…¨å±€éŒ¯èª¤è™•ç†å™¨
- éŒ¯èª¤è¿½è¹¤å’Œæ—¥èªŒèšåˆ
- æ•…éšœæ³¨å…¥æ¸¬è©¦ï¼ˆChaos EngineeringåŸºç¤ï¼‰

### 6. å‚™ä»½èˆ‡ç½é›£æ¢å¾©ï¼š
- è‡ªå‹•è³‡æ–™åº«å‚™ä»½ï¼ˆæ¯æ—¥ + æ¯é€±ï¼‰
- ç•°åœ°å‚™ä»½å­˜å„²å·²é…ç½®
- å‚™ä»½é©—è­‰è…³æœ¬è‡ªå‹•åŸ·è¡Œ
- ç½é›£æ¢å¾©æ‰‹å†Šå®Œæˆ
- RTOï¼ˆæ¢å¾©æ™‚é–“ç›®æ¨™ï¼‰: <4å°æ™‚
- RPOï¼ˆæ¢å¾©é»ç›®æ¨™ï¼‰: <1å°æ™‚
- ç½é›£æ¢å¾©æ¼”ç·´å·²åŸ·è¡Œä¸¦è¨˜éŒ„

### 7. æ€§èƒ½åŸºæº–æ¸¬è©¦ï¼š
- Lighthouse CIåˆ†æ•¸: >90ï¼ˆæ‰€æœ‰é¡åˆ¥ï¼‰
- è² è¼‰æ¸¬è©¦å ±å‘Šï¼ˆ1000+ concurrent usersï¼‰
- å£“åŠ›æ¸¬è©¦å ±å‘Šï¼ˆå³°å€¼è² è¼‰ 2xæ­£å¸¸ï¼‰
- è€ä¹…æ€§æ¸¬è©¦ï¼ˆ24å°æ™‚æŒçºŒé‹è¡Œï¼‰
- æ€§èƒ½å›æ­¸æ¸¬è©¦å·²æ•´åˆCI/CD
- æ€§èƒ½å„ªåŒ–å‰å¾Œå°æ¯”å ±å‘Š

## æŠ€è¡“å¯¦æ–½ç´°ç¯€

### å‰ç«¯å„ªåŒ–æŠ€è¡“
```typescript
// Next.js 14ä»£ç¢¼åˆ†å‰²
const ProposalEditor = dynamic(() => import('@/components/ProposalEditor'), {
  loading: () => <Skeleton />,
  ssr: false
});

// åœ–ç‰‡å„ªåŒ–
import Image from 'next/image';
<Image
  src="/hero.jpg"
  alt="Hero"
  width={800}
  height={600}
  loading="lazy"
  placeholder="blur"
/>

// ISR (Incremental Static Regeneration)
export const revalidate = 3600; // 1å°æ™‚
```

### å¾Œç«¯å„ªåŒ–æŠ€è¡“
```typescript
// Redisç·©å­˜ç­–ç•¥
const cacheKey = `user:${userId}:profile`;
const cached = await redis.get(cacheKey);
if (cached) return JSON.parse(cached);

const data = await db.user.findUnique({ where: { id: userId } });
await redis.setex(cacheKey, 3600, JSON.stringify(data));

// N+1æŸ¥è©¢å„ªåŒ–
const users = await db.user.findMany({
  include: {
    proposals: true, // ä½¿ç”¨includeè€Œéå¤šæ¬¡æŸ¥è©¢
    customers: true
  }
});

// Circuit Breakeræ¨¡å¼
import CircuitBreaker from 'opossum';

const breaker = new CircuitBreaker(callExternalAPI, {
  timeout: 3000,
  errorThresholdPercentage: 50,
  resetTimeout: 30000
});
```

### é«˜å¯ç”¨æ€§é…ç½®
```yaml
# Dockerå¥åº·æª¢æŸ¥
healthcheck:
  test: ["CMD", "curl", "-f", "http://localhost:3000/api/health"]
  interval: 30s
  timeout: 10s
  retries: 3
  start_period: 40s

# Kubernetes Readiness Probe
readinessProbe:
  httpGet:
    path: /api/health/ready
    port: 3000
  initialDelaySeconds: 10
  periodSeconds: 5
```

### è² è¼‰æ¸¬è©¦è…³æœ¬
```javascript
// k6è² è¼‰æ¸¬è©¦
import http from 'k6/http';
import { check, sleep } from 'k6';

export let options = {
  stages: [
    { duration: '2m', target: 100 },
    { duration: '5m', target: 1000 },
    { duration: '2m', target: 0 },
  ],
  thresholds: {
    'http_req_duration': ['p(95)<500'],
    'http_req_failed': ['rate<0.01'],
  },
};

export default function () {
  const res = http.get('https://api.example.com/search');
  check(res, { 'status is 200': (r) => r.status === 200 });
  sleep(1);
}
```

## ä¾è³´é—œä¿‚
- **å‰ç½®æ¢ä»¶**: MVP Phase 1å®Œæˆï¼ˆâœ…å·²å®Œæˆï¼‰
- **ä¾è³´æœå‹™**: Azure/AWSé›²ç«¯è³‡æºã€CDNæœå‹™
- **ç›¸é—œStories**:
  - Story 4.1 (é›²ç«¯åŸºç¤è¨­æ–½) - å·²å®Œæˆ
  - Story 4.2 (CI/CD) - å·²å®Œæˆ
  - Story 4.3 (ç›£æ§ç³»çµ±) - Sprint 2
  - Story 4.4 (å®‰å…¨åŠ å›º) - Sprint 3

## æˆåŠŸæŒ‡æ¨™
- é é¢åŠ è¼‰æ™‚é–“æ”¹å–„: >30%
- APIéŸ¿æ‡‰æ™‚é–“æ”¹å–„: >20%
- ç³»çµ±å¯ç”¨æ€§: é”åˆ°99.9%
- è² è¼‰èƒ½åŠ›: æ”¯æ´1000+ concurrent users
- ç½é›£æ¢å¾©æ¼”ç·´: æˆåŠŸå®Œæˆï¼ŒRTO<4å°æ™‚

## é¢¨éšªèˆ‡ç·©è§£
- **é¢¨éšª1**: æ€§èƒ½å„ªåŒ–å¯èƒ½å½±éŸ¿åŠŸèƒ½ç©©å®šæ€§
  - **ç·©è§£**: å®Œæ•´å›æ­¸æ¸¬è©¦ï¼Œåˆ†éšæ®µéƒ¨ç½²
- **é¢¨éšª2**: è² è¼‰æ¸¬è©¦å¯èƒ½å½±éŸ¿ç”Ÿç”¢ç’°å¢ƒ
  - **ç·©è§£**: ä½¿ç”¨ç¨ç«‹æ¸¬è©¦ç’°å¢ƒ
- **é¢¨éšª3**: CDNé…ç½®éŒ¯èª¤å¯èƒ½å°è‡´è³‡æºç„¡æ³•è¨ªå•
  - **ç·©è§£**: æ¼¸é€²å¼é·ç§»ï¼Œä¿ç•™å›æ»¾æ–¹æ¡ˆ

## äº¤ä»˜ç‰©
1. âœ… å‰ç«¯æ€§èƒ½å„ªåŒ–å ±å‘Š
2. âœ… å¾Œç«¯æ€§èƒ½å„ªåŒ–å ±å‘Š
3. âœ… è² è¼‰æ¸¬è©¦å®Œæ•´å ±å‘Š
4. âœ… é«˜å¯ç”¨æ€§æ¶æ§‹æ–‡æª”
5. âœ… ç½é›£æ¢å¾©æ‰‹å†Š
6. âœ… æ€§èƒ½åŸºæº–æ¸¬è©¦çµæœ
7. âœ… å„ªåŒ–å‰å¾Œå°æ¯”æ•¸æ“š

## Sprintåˆ†é…
- **Sprint**: Sprint 4ï¼ˆç¬¬7-8é€±ï¼‰
- **éšæ®µ**: éšæ®µ1 - ä¼æ¥­å°±ç·’å„ªå…ˆ
- **å„ªå…ˆç´š**: ğŸŸ¡ P1 - Highï¼ˆä¼æ¥­ç´šå¿…éœ€ï¼‰
- **é ä¼°å·¥æ™‚**: 8-10å¤©

## å‚™è¨»
æ­¤Storyæ˜¯åœ¨MVP Phase 2è¦åŠƒéç¨‹ä¸­ï¼ŒåŸºæ–¼ä¼æ¥­ç´šéœ€æ±‚åˆ†ææ–°å¢çš„åŠŸèƒ½ã€‚é›–ä¸åœ¨åŸå§‹24å€‹ç”¨æˆ¶æ•…äº‹åˆ—è¡¨ä¸­ï¼Œä½†å°æ–¼ç”¢å“é”åˆ°å¯éŠ·å”®çš„ä¼æ¥­ç´šæ¨™æº–è‡³é—œé‡è¦ã€‚æ­¤åŠŸèƒ½æºè‡ª**é¸é …Cï¼ˆç©©å¥å„ªåŒ–è·¯ç·šï¼‰**çš„éœ€æ±‚è©•ä¼°ï¼Œä¸¦æ•´åˆé€²**A+Cæ··åˆæ–¹æ¡ˆ**ä¸­ã€‚

## ç›¸é—œæ–‡æª”
- `docs/mvp2-development-plan.md` - Sprint 4è©³ç´°è¨ˆåŠƒ
- `docs/mvp2-implementation-checklist.md` - Sprint 4å¯¦æ–½æ¸…å–®
- `docs/architecture.md` - ç³»çµ±æ¶æ§‹æ–‡æª”
- `docs/performance-audit-2025.md` - æ€§èƒ½å¯©è¨ˆåŸºç·š